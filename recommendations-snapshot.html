<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Recommendations Snapshot - Sam Freund</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="stylesheet" type="text/css" href="css/qa-snapshot.css">
	<link rel="icon" type="image/x-icon" href="/images/icons/smalllogo.ico">
</head>
<body>
	<nav id="navigation" class="navbar navbar-expand-lg no-print">
		<a class="navbar-brand" href="index.html">SF</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
			aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="index.html">About</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="experience.html">Experience</a>
				</li>
				<li class="nav-item active">
					<a class="nav-link" href="portfolio.html">Portfolio <span class="visually-hidden">(current)</span></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="blog.html">Blog</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="index.html#contact">Contact</a>
				</li>
			</ul>
		</div>
	</nav>

	<main class="snapshot-page section">
		<div class="container">
			<div class="snapshot-actions no-print">
				<a href="index.html" class="snapshot-back"><i class="fas fa-arrow-left"></i> Back</a>
				<button type="button" id="printSnapshot" class="contactButton">
					<i class="fas fa-file-pdf"></i> Download Recommendations (PDF)
				</button>
			</div>

			<article class="snapshot-sheet">
				<header class="snapshot-header">
					<div>
						<h1>Recommendations Snapshot</h1>
						<p class="snapshot-role">Curated picks by Sam Freund</p>
					</div>
					<div class="snapshot-contact">
						<p id="rec-generated">Generated: --</p>
						<p id="rec-total">Total items: --</p>
						<p><a href="recommendations.html">Interactive recommendations page</a></p>
					</div>
				</header>

				<section class="snapshot-block">
					<h2>Overview</h2>
					<p>A printable summary of my current recommendation list grouped by category.</p>
				</section>

				<section id="rec-groups" class="snapshot-block">
					<p>Loading recommendations...</p>
				</section>
			</article>
		</div>
	</main>

	<footer class="copyrightSection no-print">
		<p>&copy; Sam Freund 2025</p>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
	<script>
		(function() {
			var printBtn = document.getElementById("printSnapshot");
			var groupsEl = document.getElementById("rec-groups");
			var generatedEl = document.getElementById("rec-generated");
			var totalEl = document.getElementById("rec-total");

			printBtn.addEventListener("click", function() {
				window.print();
			});

			function esc(str) {
				var d = document.createElement("div");
				d.textContent = str;
				return d.innerHTML;
			}

			function renderGroups(groups, total) {
				var order = ["books", "movies", "games", "recipes", "songs"];
				var labels = {
					books: "Books",
					movies: "Movies",
					games: "Games",
					recipes: "Recipes",
					songs: "Songs"
				};

				var html = "";
				order.forEach(function(cat) {
					var items = groups[cat] || [];
					if (!items.length) return;
					html += '<section class="snapshot-category">';
					html += '<h3>' + labels[cat] + ' (' + items.length + ')</h3>';
					html += "<ul>";
					items.forEach(function(title) {
						html += "<li>" + esc(title) + "</li>";
					});
					html += "</ul>";
					html += "</section>";
				});

				groupsEl.innerHTML = html || "<p>No recommendations found.</p>";
				totalEl.textContent = "Total items: " + total;
			}

			function parseRecommendations(doc) {
				var cards = doc.querySelectorAll(".rec-card");
				var grouped = { books: [], movies: [], games: [], recipes: [], songs: [] };
				var seen = {};
				var total = 0;

				cards.forEach(function(card) {
					var cat = (card.getAttribute("data-category") || "").toLowerCase();
					var titleEl = card.querySelector(".rec-title");
					if (!titleEl || !grouped[cat]) return;
					var title = titleEl.textContent.trim();
					var key = cat + "::" + title.toLowerCase();
					if (seen[key]) return;
					seen[key] = true;
					grouped[cat].push(title);
					total++;
				});

				return { grouped: grouped, total: total };
			}

			fetch("recommendations.html")
				.then(function(r) { return r.text(); })
				.then(function(html) {
					var parser = new DOMParser();
					var doc = parser.parseFromString(html, "text/html");
					var parsed = parseRecommendations(doc);
					renderGroups(parsed.grouped, parsed.total);
					generatedEl.textContent = "Generated: " + new Date().toLocaleDateString("en-US", {
						year: "numeric",
						month: "long",
						day: "numeric"
					});
				})
				.catch(function() {
					groupsEl.innerHTML = '<p>Could not load recommendations automatically. Use <a href="recommendations.html">the interactive page</a> and print from there.</p>';
					generatedEl.textContent = "Generated: unavailable";
					totalEl.textContent = "Total items: unavailable";
				});

			var params = new URLSearchParams(window.location.search);
			if (params.get("download") === "1") {
				setTimeout(function() {
					window.print();
				}, 700);
			}
		})();
	</script>
</body>
</html>
